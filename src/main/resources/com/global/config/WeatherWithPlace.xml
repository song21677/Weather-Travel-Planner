<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="WeatherWithPlace">

<select id="getDetailPlan" resultType="GetDetailPlanDTO">
SELECT
    D.DETAIL_PLAN_NO,
    D.DETAIL_PLAN_YMD,
    D.DETAIL_PLAN_HOUR,
    D.DETAIL_PLAN_DATE,
    P.ROAD_NAME_ADR,
    P.PLACE_CATEGORY
FROM
    DETAIL_PLAN_TB D
JOIN
    PLACE_TB P ON D.PLACE_NO = P.PLACE_NO
WHERE
    D.DETAIL_PLAN_NO = #{no}
</select>
	 


<select id ="withShortWeather" resultType="GetShortWeatherWithDTO">
SELECT f.TMP, f.PTY, f.POP, f.REH, f.PCP, f.SKY, f.WSD, f.WAV, f.IDX, f.FORECAST_DAY , f.FORECAST_TIME
FROM SHORT_TERM_FORECAST_TB f
WHERE f.idx = (
    SELECT MAX(f1.IDX)
    FROM SHORT_TERM_FORECAST_TB f1
  )
  AND f.SECOND_PRECINCT_NO = (
    SELECT s.SECOND_PRECINCT_NO
    FROM SECOND_PRECINCT_TB s
    WHERE s.SECOND_PRECINCT = #{address}
  )
</select>

<select id="withMediumWeather" resultType="MediumTerForecastDTO">
SELECT f.WFAM, f.WFPM, f.TAMIN, f.TAMAX, f.RNSTAM, f.RNSTPM, f.FORECAST_DAY
FROM MEDIUM_TERM_FORECAST_TB f
WHERE f.ANNOUNCE_DAY = (
    SELECT MAX(f1.ANNOUNCE_DAY)
    FROM MEDIUM_TERM_FORECAST_TB f1
    )
    AND f.SECOND_PRECINCT_NO = (
    SELECT s.SECOND_PRECINCT_NO
    FROM SECOND_PRECINCT_TB s
    WHERE s.SECOND_PRECINCT = #{address})
    ORDER BY f.FORECAST_DAY
</select>

</mapper>